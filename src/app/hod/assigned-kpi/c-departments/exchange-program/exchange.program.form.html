<!-- Quarter Boxes -->
<div>
  <div class="px-3" *ngFor="let tdl of department.opiAnnualTargets;let at=index;">
    <div class="d-flex justify-content-between card-header py-2 mt-2">
      <div>
        <b>Year:</b> {{tdl.year}}
      </div>
      <div class="text-right">
        <b>BASE LINE :</b>{{department.baseline}}
      </div>
    </div>
    <div class="d-flex justify-content-center">
      <div class="d-flex flex-column card-box small-box p-1 m-2 speed-p7 animate bounceIn" style="width:25%" *ngFor="let lev of tdl.levels;let in=index;">
        <div class="d-flex justify-content-between mt-2 mx-2">
          <div>
            <small>Quarter</small>
            <div class="text-uppercase">{{lev.quarter}}</div>
          </div>
          <div class="text-right">
            <small>Status (role)</small>
            <div class="text-capitalize">{{lev.status}}
              <br>({{lev.role}})</div>
          </div>
        </div>
        <div class="d-flex justify-content-between mt-2 mx-2">
          <div>
            <small>Baseline</small>
            <div>{{lev.baseline}}</div>
          </div>
          <div class="text-right">
            <small>Estimated Cost </small>
            <div>{{tdl.estimatedCost}}</div>
          </div>
        </div>
        <div class="d-flex justify-content-between mt-2 mx-2">
          <div>
            <small>Target </small>
            <div> {{lev.estimatedTargetLevel}}</div>
          </div>
          <div class="text-right">
            <small>End Date </small>
            <div>{{lev.endDate + tdl.year}}</div>
          </div>
        </div>
        <div class="d-flex justify-content-between  mt-2 mx-2">
          <div>
            <div *ngIf="lev.status!='unsubmitted'">
              <a data-toggle="modal" [attr.href]="'#myModal'+d" (click)="selectQuarter(lev);programListView = true;">
                <!-- <strong>Number of Exchange Programs</strong> -->
                <small>Exchange Programs
                  <i class="fas fa-eye"></i>
                </small>
              </a>
              <div>{{lev.exchangePrograms.length}}</div>
            </div>
          </div>
          <div class="text-right">
            <small>Current Cost </small>
            <div>{{lev.currentCost}}</div>
          </div>
        </div>
        <div class="d-flex justify-content-center mt-3" *ngIf="!lev.disable">
          <button class="btn-sp btn-primary" data-toggle="modal" [attr.data-target]="'#myModal'+d" (click)="selectQuarter(lev)" *ngIf="lev.status=='unsubmitted'">
            <i class="fas fa-sign-in-alt"></i> Fill
          </button>
          <button class="btn-sp btn-primary" *ngIf="lev.studentResearches.length&&lev.status!='locked'" (click)="lockQuarterResult(lev)"
            [disabled]="lev.disable">
            <i class="fas fa-lock"></i> Lock
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- end of quarter boxes -->


<!-- <div class="panel panel-default" *ngFor="let tdl of department.opiAnnualTargets;let at=index;">
 <div class="panel-heading">
  Year : {{tdl.year}}
 </div>
 <div class="panel-body row">
  <div class="col-lg-12" style="margin-bottom:5px;">
   <strong>BASE LINE : </strong> {{department.baseline}}
  </div>
  <div class="col-sm-6 col-md-6 col-lg-3" *ngFor="let lev of tdl.levels;let in=index;">
   <div class="panel" style="border: 1px solid #0000001c;">
    <div class="panel-body quarter-block">
     <b class="quarter">{{lev.quarter}}</b>
     <span class="status" [style.background-color]="lev.successInfo.color">{{lev.status}} - {{lev.role}}</span>
     <div class="row">
        <div class="col-sm-6">
            <strong>BASE LINE : </strong> {{lev.baseline}}
        </div>
      </div>
     <div class="row">
      <div class="col-sm-6">
       <strong>Estimated Cost </strong>: {{tdl.estimatedCost}}
      </div>
      <div class="col-sm-6">
       <strong>Target </strong>: {{lev.estimatedTargetLevel}}
      </div>
     </div>
     <div class="row">
      <div class="col-sm-6">
       <strong>End Date </strong>: {{lev.endDate + tdl.year}}
      </div>
      <div class="col-sm-6" *ngIf="lev.currentCost">
       <strong>Current Cost</strong>: {{lev.currentCost}}
      </div>      
     </div>
     <div class="row">
      <div class="col-sm-12">
       <a data-toggle="modal" [attr.href]="'#myModal'+d" (click)="selectQuarter(lev);programListView = true;"><strong>Number of Exchange Programs</strong></a> : {{lev.exchangePrograms.length}}
      </div>
     </div>
    </div>
    <div class="panel-footer text-center" *ngIf="!lev.disable">
      <button type="button" data-toggle="modal" [attr.data-target]="'#myModal'+d" (click)="selectQuarter(lev)" *ngIf="lev.status=='unsubmitted'">Fill</button>
      <button *ngIf="lev.exchangePrograms.length&&lev.status!='locked'" (click)="lockQuarterResult(lev)" [disabled]="lev.disable">Lock</button>
    </div>
   </div>
  </div>
 </div>
</div> -->



<!-- Modal -->
<div [attr.id]="'myModal'+d" class="modal fade" role="dialog">
 <div class="modal-dialog modal-lg">

  <!-- Modal content-->
  <div class="modal-content">
   <div class="modal-header">
      <h4 class="modal-title">Exchange Programs</h4>
    <button type="button" class="close" data-dismiss="modal" (click)="isUpdating=false">&times;</button>
   </div>
   <form class="form-horizontal" [formGroup]="exchangeProgramForm" (submit)="submitForm()" *ngIf="!programListView">
    <div class="modal-body">
     <div class="form-group">
      <label class="control-label col-sm-4">Program:</label>
      <div class="col-sm-8">
       <input type="text" class="form-control" placeholder="Enter Program" formControlName="program">
      </div>
     </div>
     <div class="form-group">
      <label class="control-label col-sm-4">Description:</label>
      <div class="col-sm-8">
       <textarea class="form-control" formControlName="description" rows="2"></textarea>
      </div>
     </div>
     <div class="form-group">
      <label class="control-label col-sm-4">Current Cost:</label>
      <div class="col-sm-8">
       <input type="number" class="form-control" placeholder="Enter Current Cost" formControlName="currentCost">
      </div>
     </div>
     <div class="form-group">
      <label class="control-label col-sm-4">Partner Organization:</label>
      <div class="col-sm-8">
       <input type="text" class="form-control" formControlName="partnerOrganization">
      </div>
     </div>
     <div class="form-group">
      <label class="control-label col-sm-4">Duration:</label>
      <div class="col-sm-8">
       <input type="text" class="form-control" formControlName="duration">
      </div>
     </div>
     <div class="form-group">
      <label class="control-label col-sm-4">Number ofInside Participants:</label>
      <div class="col-sm-8">
       <input type="number" class="form-control" formControlName="totalInsideParticipants">
      </div>
     </div>
     <div class="form-group">
      <label class="control-label col-sm-4">Number of Female Inside Participants:</label>
      <div class="col-sm-8">
       <input type="number" class="form-control" formControlName="totalFemaleInsideParticipants">
      </div>
     </div>
     <div class="form-group">
      <label class="control-label col-sm-4">Number of Outside Participants:</label>
      <div class="col-sm-8">
       <input type="number" class="form-control" formControlName="totalOutsideParticipants">
      </div>
     </div>
     <div class="form-group">
      <label class="control-label col-sm-4">Number of National Participants: </label>
      <div class="col-sm-8">
       <input type="number" class="form-control" formControlName="totalNationalParticipants">
      </div>
     </div>
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-default" (click)="programListView = true;">
        <span class="glyphicon glyphicon-arrow-left"></span> Back
      </button>
      <button type="submit" class="btn btn-default" [disabled]="exchangeProgramForm.invalid"> Submit</button>
     <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
    </div>
   </form>
   <div *ngIf="programListView">
    <div class="modal-body">
     <table class="table table-bordered table-card" style="position: relative;">
      <caption>
       <strong><u>Exchange Programs</u></strong>
       <button class="pull-right">
         <span class="glyphicon glyphicon-plus"></span>
       </button>       
     </caption>
     <thead>
      <tr>
       <th style="vertical-align:middle;">*</th>
       <th style="vertical-align:middle;">Program</th>
       <th style="vertical-align:middle;">Description</th>
       <th style="vertical-align:middle;">Duration</th>
       <th style="vertical-align:middle;">Partners' Organisation</th>
       <th style="vertical-align:middle;">No. of Inside Participants</th>
       <th style="vertical-align:middle;">No. of Female Participants</th>
       <th style="vertical-align:middle;">No. of Outside Participants</th>
       <th style="vertical-align:middle;">No. of National Participants</th>
       <th style="vertical-align: middle">Evidence</th>
      </tr>
     </thead>
     <tbody>
      <tr *ngFor="let program of selectedQuarter.exchangePrograms;let p = index;" style="position: relative;">
       <td>{{p+1}}</td>
       <td>{{program.program}}</td>
       <td>{{program.description}}</td>
       <td>{{program.duration}}</td>
       <td>{{program.partnerOrganization}}</td>
       <td>{{program.totalInsideParticipants}}</td>
       <td>{{program.totalFemaleInsideParticipants}}</td>
       <td>{{program.totalOutsideParticipants}}</td>
       <td>{{program.totalNationalParticipants}}</td>
       <td>
        <div class="dropdown">
          <strong>Evidence </strong>:
          <a class="text-primary link primary-link dropdown-toggle" id="menu1" data-toggle="dropdown"><small>Files</small> {{program.evidance.length}}
            <span class="caret"></span>
          </a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="menu" style="right: 0;left:unset;font-size:12px;">
            <li role="presentation" *ngFor="let ev of program.evidance;let e = index;">
              <a class="btn-link" role="menuitem" tabindex="-1" [attr.href]="ev.url" style="float:left">evidance {{e+1}}</a>
              <button type="button" class="close" (click)="deleteEvidence(ev,program.evidance)" [hidden]="selectedQuarter.status=='locked'">
                <span aria-hidden="true">&times;</span>
              </button>
            </li>
            <li class="text-center" role="presentation" *ngIf="!program.evidance.length">None</li>
            <li role="presentation" class="divider" style="clear: both;"></li>
            <li class="text-center" role="presentation">
              <!-- <button *ngIf="selectedQuarter.status=='inprogress'||selectedQuarter.status=='rejected'" data-toggle="modal" data-target="#evidenceForm" [disabled]="selectedQuarter.disable" (click)="selectProgram(program)"> Upload</button> -->
              <button *ngIf="selectedQuarter.status=='inprogress'||selectedQuarter.status=='rejected'" data-toggle="modal" [attr.data-target]="'#evidenceForm'+ formId" (click)="selectedForm = program" [disabled]="selectedQuarter.disable">Upload</button>
            </li>
          </ul>
        </div>
      </td>
       <span class="option">
        <button (click)="edit(program)"><span class="glyphicon glyphicon-pencil"></span></button>
        <button (click)="delete(program,selectedQuarter.exchangePrograms)"><span class="glyphicon glyphicon-trash"></span></button>
       </span>
      </tr>
     </tbody>
     </table>
    </div>
    <div class="modal-footer">
      <button type="button" class="btn-sp btn-primary" (click)="programListView = false;resetForm()">
        <span class="glyphicon glyphicon-plus"></span> Add
      </button>
      <button type="button" class="btn-sp btn-clear" data-dismiss="modal" (click)="isUpdating=false">Close</button>
    </div>
   </div>
  </div>
 </div>
</div>

<evidence-form [evidanceFormId]="formId" [selectedForm]="selectedForm" *ngIf="selectedForm"></evidence-form>